/* Action bar: shared by CMD+K hints, page dialog footer, and tag popover */
.hints {
  @apply flex w-full px-3 py-2 gap-2 justify-between items-center
  bg-gray-03 border-t border-gray-05;
  min-height: 45px;
}

.hints-actions {
  @apply flex items-center gap-2;
  flex-shrink: 0;
}

/* Tip text: never wraps, truncates only the trailing text (.hints-tip-tail).
   Every flex ancestor in the chain needs overflow:hidden + min-width:0
   so the width constraint propagates down to the ellipsis element. */
.hints-tip {
  overflow: hidden;
  min-width: 0;
}

.hints-tip,
.hints-tip * {
  white-space: nowrap;
  min-width: 0;
}

/* Propagate overflow clipping through all intermediate containers */
.hints-tip > *,
.hints-tip > * > *,
.hints-tip > * > * > * {
  overflow: hidden;
}

/* Leaf text spans and shortcut badges never shrink.
   :not(.hints-tip-tail) prevents this from overriding the tail rule. */
.hints-tip span:not(.hints-tip-tail) {
  flex-shrink: 0;
}

/* Only the trailing text truncates with ellipsis.
   .hints-tip prefix gives specificity 0,0,2,0 which beats
   .hints-tip span (0,0,1,1) so flex-shrink:1 actually applies. */
.hints-tip .hints-tip-tail {
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
  flex-shrink: 1;
}

.ls-dialog-cmdk {
  @apply p-0 overflow-hidden flex flex-col;
  width: 90dvw !important;
  max-width: 56rem !important; /* 4xl */
  height: 75dvh !important;

  > .ui__dialog-main-content {
    @apply flex-1 min-h-0;
  }

}

/* Rotating tip fade-in */
@keyframes tipFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.tip-rotate {
  animation: tipFadeIn 300ms ease-in;
}

@media (prefers-reduced-motion: reduce) {
  .tip-rotate {
    animation: none;
  }
}

/* Capture mode toolbar */
.capture-toolbar {
  @apply flex items-center gap-2 px-4 py-2.5;
  min-height: 48px;
  background: linear-gradient(to top, transparent 0%,
    color-mix(in srgb, var(--lx-gray-03) 30%, transparent) 30%,
    color-mix(in srgb, var(--lx-gray-03) 70%, transparent) 60%,
    var(--lx-gray-03) 100%);
}

.capture-toolbar .target-label {
  @apply text-sm text-gray-11;
}

.capture-toolbar .target-pill {
  @apply flex items-center gap-1.5 px-2.5 py-1 rounded-md text-sm;
  @apply bg-gray-04 hover:bg-gray-05 cursor-pointer transition-colors;
}

/* Capture editor area */
.capture-editor {
  @apply flex-1 min-h-0 overflow-y-auto px-6 py-4;
}

/* Target page picker popover */
.target-page-picker {
  min-width: 280px;
  max-width: 360px;
  padding-bottom: 4px;
}

/* ============================================================
   Preview split layout
   ============================================================ */
.cmdk-body {
  display: flex;
  flex: 1;
  min-height: 0;
}

.cmdk-results-list {
  flex: 1 1 100%;
  min-width: 0;
  overflow-y: auto;
  transition: flex-basis 100ms ease-out;
}

.cmdk-has-preview .cmdk-results-list {
  flex-basis: 50%;
}

.cmdk-preview-container {
  flex: 0 1 50%;
  min-width: 0;
  max-width: 50%;
  border-left: 1px solid var(--lx-gray-06, var(--ls-border-color));
  overflow: hidden;
  display: flex;
  flex-direction: column;
  cursor: pointer;
  background: var(--lx-gray-02, var(--ls-secondary-background-color));
}

.cmdk-preview-pane {
  overflow-y: auto;
  flex: 1;
  min-height: 0;
}

/* Suppress clicks on content but allow scrolling on the pane */
.cmdk-preview-pane > * {
  pointer-events: none;
}

/* Page title */
.preview-page-title {
  background: linear-gradient(to top, transparent 0%,
    color-mix(in srgb, var(--lx-gray-03) 30%, transparent) 30%,
    color-mix(in srgb, var(--lx-gray-03) 70%, transparent) 60%,
    var(--lx-gray-03) 100%);
}

/* Block list */
.preview-blocks {
  padding: 0 0.5rem 1rem;
}

.preview-block {
  padding: 1px 0;
}

.preview-block-content {
  font-size: 0.85rem;
  line-height: 1.5;
}

.preview-bullet {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--lx-gray-08, var(--ls-block-bullet-color));
  flex-shrink: 0;
  margin-top: 0.45em;
}

.preview-bullet.collapsed {
  background: var(--lx-accent-09, var(--ls-link-text-color));
}

.preview-block-body {
  margin-top: 2px;
  font-size: 0.82rem;
  color: var(--lx-gray-11, var(--ls-secondary-text-color));
}

.preview-block-body .is-paragraph {
  margin: 0.25em 0;
}

/* Code blocks in preview */
.preview-block-body .cp__fenced-code-block {
  margin: 0.25em 0;
}

.preview-block-body .cp__fenced-code-block pre {
  font-size: 0.8rem;
  padding: 0.5rem;
  border-radius: 4px;
  background: var(--lx-gray-03, var(--ls-secondary-background-color));
  overflow-x: auto;
}

/* Block highlight for auto-scroll target.
   Uses a keyframe animation that flashes brighter then settles to a persistent
   subtle tint.  The class is never removed, so the highlight stays visible no
   matter how long the user pauses before reading -- essential during rapid
   arrow-key scanning where a fade-out would leave nothing visible. */
@keyframes cmdk-highlight-settle {
  0%   { background: var(--lx-accent-04-alpha, rgba(59, 130, 246, 0.22)); }
  100% { background: var(--lx-accent-03-alpha, rgba(59, 130, 246, 0.12)); }
}

.cmdk-preview-highlight {
  border-radius: 4px;
  animation: cmdk-highlight-settle 600ms ease-out forwards;
}

/* Fade-in when content replaces skeleton */
@keyframes cmdk-content-appear {
  from { opacity: 0; }
  to   { opacity: 1; }
}

.cmdk-preview-content {
  animation: cmdk-content-appear 150ms ease-out;
}

/* Soft bottom fade â€“ only shown when content overflows (JS toggles .has-overflow) */
.cmdk-preview-pane.has-overflow::after {
  content: '';
  position: sticky;
  bottom: 0;
  display: block;
  height: 40px;
  background: linear-gradient(to top,
    var(--lx-gray-02, var(--ls-secondary-background-color)) 0%,
    transparent 100%);
  pointer-events: none;
  margin-top: -40px;
}

/* Wikilink styling in CMD+K results */
.cmdk-results-list .page-reference:hover {
  background: transparent;
}

/* Non-selected items: grey page refs for greyscale hierarchy */
.cmdk-results-list .page-ref {
  color: var(--lx-gray-11);
}

/* Hovered or selected item: restore accent color */
.cmdk-results-list .is-hovered .page-ref,
.cmdk-results-list .bg-gray-03-alpha .page-ref {
  color: var(--lx-accent-11, var(--ls-link-text-color, hsl(var(--primary)/.8)));
}

@media (prefers-reduced-motion: reduce) {
  .cmdk-results-list { transition: none; }
  .cmdk-preview-highlight { animation: none; background: var(--lx-accent-03-alpha, rgba(59, 130, 246, 0.12)); }
  .cmdk-preview-content { animation: none; }
}

